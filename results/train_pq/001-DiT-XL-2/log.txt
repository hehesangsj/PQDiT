[[34m2024-09-25 14:47:01[0m] Experiment directory created at results/001-DiT-XL-2
[[34m2024-09-25 14:47:46[0m] blocks.0.attn.qkv compression: 1000; mse: 1.223202e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 14:48:10[0m] blocks.0.attn.proj compression: 1000; mse: 5.784003e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 14:48:40[0m] blocks.0.mlp.fc1 compression: 1000; mse: 4.114613e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 14:49:09[0m] blocks.0.mlp.fc2 compression: 1000; mse: 2.412441e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 14:49:42[0m] blocks.0.adaLN_modulation.1 compression: 1000; mse: 9.226966e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 14:50:10[0m] blocks.1.attn.qkv compression: 1000; mse: 1.891406e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 14:50:34[0m] blocks.1.attn.proj compression: 1000; mse: 7.477111e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 14:51:03[0m] blocks.1.mlp.fc1 compression: 1000; mse: 7.331926e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 14:51:32[0m] blocks.1.mlp.fc2 compression: 1000; mse: 1.207021e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 14:52:05[0m] blocks.1.adaLN_modulation.1 compression: 1000; mse: 5.673295e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 14:52:33[0m] blocks.2.attn.qkv compression: 1000; mse: 1.345342e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 14:52:57[0m] blocks.2.attn.proj compression: 1000; mse: 4.448490e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 14:53:26[0m] blocks.2.mlp.fc1 compression: 1000; mse: 5.086829e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 14:53:56[0m] blocks.2.mlp.fc2 compression: 1000; mse: 1.924111e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 14:54:29[0m] blocks.2.adaLN_modulation.1 compression: 1000; mse: 5.662751e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 14:54:57[0m] blocks.3.attn.qkv compression: 1000; mse: 4.740166e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 14:55:20[0m] blocks.3.attn.proj compression: 1000; mse: 1.103397e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 14:55:50[0m] blocks.3.mlp.fc1 compression: 1000; mse: 1.603445e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 14:56:19[0m] blocks.3.mlp.fc2 compression: 1000; mse: 2.393252e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 14:56:53[0m] blocks.3.adaLN_modulation.1 compression: 1000; mse: 7.639934e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 14:57:20[0m] blocks.4.attn.qkv compression: 1000; mse: 8.924254e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 14:57:44[0m] blocks.4.attn.proj compression: 1000; mse: 1.238807e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 14:58:13[0m] blocks.4.mlp.fc1 compression: 1000; mse: 9.542727e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 14:58:43[0m] blocks.4.mlp.fc2 compression: 1000; mse: 9.224291e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 14:59:16[0m] blocks.4.adaLN_modulation.1 compression: 1000; mse: 8.655136e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 14:59:43[0m] blocks.5.attn.qkv compression: 1000; mse: 1.183791e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:00:07[0m] blocks.5.attn.proj compression: 1000; mse: 1.437510e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:00:37[0m] blocks.5.mlp.fc1 compression: 1000; mse: 1.495921e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:01:06[0m] blocks.5.mlp.fc2 compression: 1000; mse: 1.883796e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:01:40[0m] blocks.5.adaLN_modulation.1 compression: 1000; mse: 9.809918e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:02:07[0m] blocks.6.attn.qkv compression: 1000; mse: 1.602241e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:02:31[0m] blocks.6.attn.proj compression: 1000; mse: 1.708357e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:03:01[0m] blocks.6.mlp.fc1 compression: 1000; mse: 1.652811e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:03:30[0m] blocks.6.mlp.fc2 compression: 1000; mse: 1.963220e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:04:04[0m] blocks.6.adaLN_modulation.1 compression: 1000; mse: 9.170778e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:04:31[0m] blocks.7.attn.qkv compression: 1000; mse: 1.721809e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:04:55[0m] blocks.7.attn.proj compression: 1000; mse: 1.604176e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:05:25[0m] blocks.7.mlp.fc1 compression: 1000; mse: 1.773273e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:05:54[0m] blocks.7.mlp.fc2 compression: 1000; mse: 2.004869e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:06:27[0m] blocks.7.adaLN_modulation.1 compression: 1000; mse: 1.086483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:06:55[0m] blocks.8.attn.qkv compression: 1000; mse: 1.769114e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:07:19[0m] blocks.8.attn.proj compression: 1000; mse: 1.904257e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:07:49[0m] blocks.8.mlp.fc1 compression: 1000; mse: 1.858805e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:08:18[0m] blocks.8.mlp.fc2 compression: 1000; mse: 2.139965e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:08:51[0m] blocks.8.adaLN_modulation.1 compression: 1000; mse: 1.155304e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:09:19[0m] blocks.9.attn.qkv compression: 1000; mse: 1.772857e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:09:43[0m] blocks.9.attn.proj compression: 1000; mse: 2.007805e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:10:12[0m] blocks.9.mlp.fc1 compression: 1000; mse: 1.904299e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:10:41[0m] blocks.9.mlp.fc2 compression: 1000; mse: 2.249118e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:11:15[0m] blocks.9.adaLN_modulation.1 compression: 1000; mse: 1.319698e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:11:43[0m] blocks.10.attn.qkv compression: 1000; mse: 1.769889e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:12:07[0m] blocks.10.attn.proj compression: 1000; mse: 2.191791e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:12:36[0m] blocks.10.mlp.fc1 compression: 1000; mse: 1.966307e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:13:05[0m] blocks.10.mlp.fc2 compression: 1000; mse: 2.382253e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:13:39[0m] blocks.10.adaLN_modulation.1 compression: 1000; mse: 1.698302e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:14:06[0m] blocks.11.attn.qkv compression: 1000; mse: 1.805447e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:14:31[0m] blocks.11.attn.proj compression: 1000; mse: 2.103099e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:15:00[0m] blocks.11.mlp.fc1 compression: 1000; mse: 1.971021e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:15:30[0m] blocks.11.mlp.fc2 compression: 1000; mse: 2.431537e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:16:03[0m] blocks.11.adaLN_modulation.1 compression: 1000; mse: 1.581191e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:16:31[0m] blocks.12.attn.qkv compression: 1000; mse: 1.850807e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:16:55[0m] blocks.12.attn.proj compression: 1000; mse: 2.316541e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:17:24[0m] blocks.12.mlp.fc1 compression: 1000; mse: 1.957412e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:17:53[0m] blocks.12.mlp.fc2 compression: 1000; mse: 2.432965e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:18:27[0m] blocks.12.adaLN_modulation.1 compression: 1000; mse: 1.586206e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:18:54[0m] blocks.13.attn.qkv compression: 1000; mse: 2.027285e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:19:18[0m] blocks.13.attn.proj compression: 1000; mse: 2.346170e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:19:48[0m] blocks.13.mlp.fc1 compression: 1000; mse: 1.893710e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:20:17[0m] blocks.13.mlp.fc2 compression: 1000; mse: 2.414092e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:20:50[0m] blocks.13.adaLN_modulation.1 compression: 1000; mse: 1.526879e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:21:18[0m] blocks.14.attn.qkv compression: 1000; mse: 1.919666e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:21:42[0m] blocks.14.attn.proj compression: 1000; mse: 2.435264e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:22:11[0m] blocks.14.mlp.fc1 compression: 1000; mse: 1.894395e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:22:40[0m] blocks.14.mlp.fc2 compression: 1000; mse: 2.587469e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:23:14[0m] blocks.14.adaLN_modulation.1 compression: 1000; mse: 1.869856e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:23:41[0m] blocks.15.attn.qkv compression: 1000; mse: 1.998632e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:24:05[0m] blocks.15.attn.proj compression: 1000; mse: 2.402870e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:24:34[0m] blocks.15.mlp.fc1 compression: 1000; mse: 1.860853e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:25:04[0m] blocks.15.mlp.fc2 compression: 1000; mse: 2.521253e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:25:37[0m] blocks.15.adaLN_modulation.1 compression: 1000; mse: 1.674303e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:26:05[0m] blocks.16.attn.qkv compression: 1000; mse: 2.145478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:26:29[0m] blocks.16.attn.proj compression: 1000; mse: 2.381409e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:26:58[0m] blocks.16.mlp.fc1 compression: 1000; mse: 1.795489e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:27:27[0m] blocks.16.mlp.fc2 compression: 1000; mse: 2.444266e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:28:01[0m] blocks.16.adaLN_modulation.1 compression: 1000; mse: 1.371870e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:28:28[0m] blocks.17.attn.qkv compression: 1000; mse: 2.054746e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:28:52[0m] blocks.17.attn.proj compression: 1000; mse: 2.463474e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:29:22[0m] blocks.17.mlp.fc1 compression: 1000; mse: 1.764557e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:29:51[0m] blocks.17.mlp.fc2 compression: 1000; mse: 2.466746e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:30:24[0m] blocks.17.adaLN_modulation.1 compression: 1000; mse: 1.321043e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:30:52[0m] blocks.18.attn.qkv compression: 1000; mse: 2.008011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:31:15[0m] blocks.18.attn.proj compression: 1000; mse: 2.528407e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:31:45[0m] blocks.18.mlp.fc1 compression: 1000; mse: 1.779605e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:32:14[0m] blocks.18.mlp.fc2 compression: 1000; mse: 2.463819e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:32:47[0m] blocks.18.adaLN_modulation.1 compression: 1000; mse: 1.291974e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:33:15[0m] blocks.19.attn.qkv compression: 1000; mse: 1.954242e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:33:39[0m] blocks.19.attn.proj compression: 1000; mse: 2.474125e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:34:08[0m] blocks.19.mlp.fc1 compression: 1000; mse: 1.749971e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:34:37[0m] blocks.19.mlp.fc2 compression: 1000; mse: 2.534788e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:35:10[0m] blocks.19.adaLN_modulation.1 compression: 1000; mse: 1.292627e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:35:38[0m] blocks.20.attn.qkv compression: 1000; mse: 1.975776e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:36:02[0m] blocks.20.attn.proj compression: 1000; mse: 2.622409e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:36:31[0m] blocks.20.mlp.fc1 compression: 1000; mse: 1.768696e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:37:00[0m] blocks.20.mlp.fc2 compression: 1000; mse: 2.565231e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:37:33[0m] blocks.20.adaLN_modulation.1 compression: 1000; mse: 1.346694e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:38:01[0m] blocks.21.attn.qkv compression: 1000; mse: 1.887958e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:38:25[0m] blocks.21.attn.proj compression: 1000; mse: 2.659318e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:38:54[0m] blocks.21.mlp.fc1 compression: 1000; mse: 1.795531e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:39:24[0m] blocks.21.mlp.fc2 compression: 1000; mse: 2.615868e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:39:57[0m] blocks.21.adaLN_modulation.1 compression: 1000; mse: 1.431723e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:40:25[0m] blocks.22.attn.qkv compression: 1000; mse: 1.844585e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:40:49[0m] blocks.22.attn.proj compression: 1000; mse: 2.665209e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:41:18[0m] blocks.22.mlp.fc1 compression: 1000; mse: 1.775678e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:41:47[0m] blocks.22.mlp.fc2 compression: 1000; mse: 2.573509e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:42:20[0m] blocks.22.adaLN_modulation.1 compression: 1000; mse: 1.434964e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:42:48[0m] blocks.23.attn.qkv compression: 1000; mse: 1.869353e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:43:12[0m] blocks.23.attn.proj compression: 1000; mse: 2.631523e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:43:41[0m] blocks.23.mlp.fc1 compression: 1000; mse: 1.749365e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:44:11[0m] blocks.23.mlp.fc2 compression: 1000; mse: 2.676450e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:44:44[0m] blocks.23.adaLN_modulation.1 compression: 1000; mse: 1.467838e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:45:12[0m] blocks.24.attn.qkv compression: 1000; mse: 1.875529e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:45:35[0m] blocks.24.attn.proj compression: 1000; mse: 2.877039e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:46:05[0m] blocks.24.mlp.fc1 compression: 1000; mse: 1.714125e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:46:34[0m] blocks.24.mlp.fc2 compression: 1000; mse: 2.688817e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:47:07[0m] blocks.24.adaLN_modulation.1 compression: 1000; mse: 1.386063e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:47:35[0m] blocks.25.attn.qkv compression: 1000; mse: 1.933233e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:47:59[0m] blocks.25.attn.proj compression: 1000; mse: 2.860930e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:48:28[0m] blocks.25.mlp.fc1 compression: 1000; mse: 1.640132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:48:58[0m] blocks.25.mlp.fc2 compression: 1000; mse: 2.707800e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:49:31[0m] blocks.25.adaLN_modulation.1 compression: 1000; mse: 1.293151e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:49:59[0m] blocks.26.attn.qkv compression: 1000; mse: 1.749674e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:50:23[0m] blocks.26.attn.proj compression: 1000; mse: 2.626899e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:50:52[0m] blocks.26.mlp.fc1 compression: 1000; mse: 1.406641e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:51:22[0m] blocks.26.mlp.fc2 compression: 1000; mse: 1.224584e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:51:55[0m] blocks.26.adaLN_modulation.1 compression: 1000; mse: 8.026871e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:52:23[0m] blocks.27.attn.qkv compression: 1000; mse: 1.439805e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-09-25 15:52:46[0m] blocks.27.attn.proj compression: 1000; mse: 8.821069e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-09-25 15:53:16[0m] blocks.27.mlp.fc1 compression: 1000; mse: 5.228269e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-09-25 15:53:45[0m] blocks.27.mlp.fc2 compression: 1000; mse: 1.430990e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-09-25 15:54:18[0m] blocks.27.adaLN_modulation.1 compression: 1000; mse: 4.652555e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-09-25 15:54:18[0m] Uncompressed model size: 21604148224 bits
[[34m2024-09-25 15:54:18[0m] Compressed model size: 1540629504 bits
[[34m2024-09-25 15:54:18[0m] Compression ratio: 14.02
[[34m2024-09-25 15:55:16[0m] DiT Parameters: 173,627,680
[[34m2024-09-25 15:56:13[0m] Dataset contains 1,281,167 images (/mnt/petrelfs/share/images/train)
[[34m2024-09-25 15:56:13[0m] Training for 1 epochs...
[[34m2024-09-25 15:56:13[0m] Beginning epoch 0...
[[34m2024-09-25 15:57:15[0m] (step=0000100) Train Loss: 0.1602, Train Steps/Sec: 1.62
[[34m2024-09-25 15:58:15[0m] (step=0000200) Train Loss: 0.1498, Train Steps/Sec: 1.65
[[34m2024-09-25 15:59:16[0m] (step=0000300) Train Loss: 0.1478, Train Steps/Sec: 1.65
[[34m2024-09-25 16:00:16[0m] (step=0000400) Train Loss: 0.1477, Train Steps/Sec: 1.65
[[34m2024-09-25 16:01:17[0m] (step=0000500) Train Loss: 0.1472, Train Steps/Sec: 1.65
[[34m2024-09-25 16:02:17[0m] (step=0000600) Train Loss: 0.1488, Train Steps/Sec: 1.65
[[34m2024-09-25 16:03:18[0m] (step=0000700) Train Loss: 0.1463, Train Steps/Sec: 1.65
[[34m2024-09-25 16:04:18[0m] (step=0000800) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-09-25 16:05:19[0m] (step=0000900) Train Loss: 0.1454, Train Steps/Sec: 1.65
[[34m2024-09-25 16:06:20[0m] (step=0001000) Train Loss: 0.1477, Train Steps/Sec: 1.65
[[34m2024-09-25 16:07:20[0m] (step=0001100) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-09-25 16:08:21[0m] (step=0001200) Train Loss: 0.1474, Train Steps/Sec: 1.65
[[34m2024-09-25 16:09:22[0m] (step=0001300) Train Loss: 0.1480, Train Steps/Sec: 1.64
[[34m2024-09-25 16:10:22[0m] (step=0001400) Train Loss: 0.1460, Train Steps/Sec: 1.65
[[34m2024-09-25 16:11:23[0m] (step=0001500) Train Loss: 0.1455, Train Steps/Sec: 1.65
[[34m2024-09-25 16:12:23[0m] (step=0001600) Train Loss: 0.1445, Train Steps/Sec: 1.65
[[34m2024-09-25 16:13:24[0m] (step=0001700) Train Loss: 0.1480, Train Steps/Sec: 1.65
[[34m2024-09-25 16:14:24[0m] (step=0001800) Train Loss: 0.1476, Train Steps/Sec: 1.65
[[34m2024-09-25 16:15:25[0m] (step=0001900) Train Loss: 0.1462, Train Steps/Sec: 1.65
[[34m2024-09-25 16:16:25[0m] (step=0002000) Train Loss: 0.1467, Train Steps/Sec: 1.65
[[34m2024-09-25 16:17:26[0m] (step=0002100) Train Loss: 0.1463, Train Steps/Sec: 1.65
[[34m2024-09-25 16:18:26[0m] (step=0002200) Train Loss: 0.1466, Train Steps/Sec: 1.65
[[34m2024-09-25 16:19:27[0m] (step=0002300) Train Loss: 0.1417, Train Steps/Sec: 1.65
[[34m2024-09-25 16:20:27[0m] (step=0002400) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-09-25 16:21:28[0m] (step=0002500) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-09-25 16:22:28[0m] (step=0002600) Train Loss: 0.1476, Train Steps/Sec: 1.65
[[34m2024-09-25 16:23:29[0m] (step=0002700) Train Loss: 0.1465, Train Steps/Sec: 1.65
[[34m2024-09-25 16:24:29[0m] (step=0002800) Train Loss: 0.1448, Train Steps/Sec: 1.65
[[34m2024-09-25 16:25:30[0m] (step=0002900) Train Loss: 0.1451, Train Steps/Sec: 1.65
[[34m2024-09-25 16:26:30[0m] (step=0003000) Train Loss: 0.1461, Train Steps/Sec: 1.65
[[34m2024-09-25 16:27:31[0m] (step=0003100) Train Loss: 0.1464, Train Steps/Sec: 1.65
[[34m2024-09-25 16:28:31[0m] (step=0003200) Train Loss: 0.1491, Train Steps/Sec: 1.65
[[34m2024-09-25 16:29:32[0m] (step=0003300) Train Loss: 0.1471, Train Steps/Sec: 1.65
[[34m2024-09-25 16:30:32[0m] (step=0003400) Train Loss: 0.1449, Train Steps/Sec: 1.65
[[34m2024-09-25 16:31:33[0m] (step=0003500) Train Loss: 0.1446, Train Steps/Sec: 1.65
[[34m2024-09-25 16:32:34[0m] (step=0003600) Train Loss: 0.1444, Train Steps/Sec: 1.64
[[34m2024-09-25 16:33:35[0m] (step=0003700) Train Loss: 0.1455, Train Steps/Sec: 1.64
[[34m2024-09-25 16:34:35[0m] (step=0003800) Train Loss: 0.1451, Train Steps/Sec: 1.65
[[34m2024-09-25 16:35:36[0m] (step=0003900) Train Loss: 0.1437, Train Steps/Sec: 1.65
[[34m2024-09-25 16:36:36[0m] (step=0004000) Train Loss: 0.1465, Train Steps/Sec: 1.65
[[34m2024-09-25 16:37:37[0m] (step=0004100) Train Loss: 0.1436, Train Steps/Sec: 1.65
[[34m2024-09-25 16:38:37[0m] (step=0004200) Train Loss: 0.1431, Train Steps/Sec: 1.65
[[34m2024-09-25 16:39:38[0m] (step=0004300) Train Loss: 0.1434, Train Steps/Sec: 1.65
[[34m2024-09-25 16:40:38[0m] (step=0004400) Train Loss: 0.1427, Train Steps/Sec: 1.65
[[34m2024-09-25 16:41:39[0m] (step=0004500) Train Loss: 0.1440, Train Steps/Sec: 1.65
[[34m2024-09-25 16:42:39[0m] (step=0004600) Train Loss: 0.1449, Train Steps/Sec: 1.65
[[34m2024-09-25 16:43:40[0m] (step=0004700) Train Loss: 0.1489, Train Steps/Sec: 1.65
[[34m2024-09-25 16:44:40[0m] (step=0004800) Train Loss: 0.1438, Train Steps/Sec: 1.65
[[34m2024-09-25 16:45:41[0m] (step=0004900) Train Loss: 0.1463, Train Steps/Sec: 1.66
[[34m2024-09-25 16:46:41[0m] (step=0005000) Train Loss: 0.1445, Train Steps/Sec: 1.65
[[34m2024-09-25 16:46:42[0m] Saved checkpoint to results/001-DiT-XL-2/checkpoints/0005000.pt
[[34m2024-10-22 15:41:51[0m] Experiment directory created at results/train_pq/001-DiT-XL-2
[[34m2024-10-22 15:48:34[0m] Experiment directory created at results/train_pq/001-DiT-XL-2
[[34m2024-10-22 15:49:16[0m] blocks.0.attn.qkv compression: 1000; mse: 1.223202e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:49:40[0m] blocks.0.attn.proj compression: 1000; mse: 5.784003e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:50:09[0m] blocks.0.mlp.fc1 compression: 1000; mse: 4.114613e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:50:39[0m] blocks.0.mlp.fc2 compression: 1000; mse: 2.412441e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:51:12[0m] blocks.0.adaLN_modulation.1 compression: 1000; mse: 9.226966e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:51:39[0m] blocks.1.attn.qkv compression: 1000; mse: 1.891406e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:52:03[0m] blocks.1.attn.proj compression: 1000; mse: 7.477111e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:52:32[0m] blocks.1.mlp.fc1 compression: 1000; mse: 7.331926e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:53:01[0m] blocks.1.mlp.fc2 compression: 1000; mse: 1.207021e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:53:35[0m] blocks.1.adaLN_modulation.1 compression: 1000; mse: 5.673295e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:54:02[0m] blocks.2.attn.qkv compression: 1000; mse: 1.345342e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:54:26[0m] blocks.2.attn.proj compression: 1000; mse: 4.448490e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:54:55[0m] blocks.2.mlp.fc1 compression: 1000; mse: 5.086829e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:55:24[0m] blocks.2.mlp.fc2 compression: 1000; mse: 1.924111e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:55:57[0m] blocks.2.adaLN_modulation.1 compression: 1000; mse: 5.662751e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:56:25[0m] blocks.3.attn.qkv compression: 1000; mse: 4.740166e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:56:49[0m] blocks.3.attn.proj compression: 1000; mse: 1.103397e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:57:18[0m] blocks.3.mlp.fc1 compression: 1000; mse: 1.603445e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:57:48[0m] blocks.3.mlp.fc2 compression: 1000; mse: 2.393252e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:58:21[0m] blocks.3.adaLN_modulation.1 compression: 1000; mse: 7.639934e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:58:48[0m] blocks.4.attn.qkv compression: 1000; mse: 8.924254e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:59:12[0m] blocks.4.attn.proj compression: 1000; mse: 1.238807e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:59:42[0m] blocks.4.mlp.fc1 compression: 1000; mse: 9.542727e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:00:11[0m] blocks.4.mlp.fc2 compression: 1000; mse: 9.224291e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:00:44[0m] blocks.4.adaLN_modulation.1 compression: 1000; mse: 8.655136e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:01:11[0m] blocks.5.attn.qkv compression: 1000; mse: 1.183791e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:01:35[0m] blocks.5.attn.proj compression: 1000; mse: 1.437510e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:02:04[0m] blocks.5.mlp.fc1 compression: 1000; mse: 1.495921e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:02:34[0m] blocks.5.mlp.fc2 compression: 1000; mse: 1.883796e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:03:07[0m] blocks.5.adaLN_modulation.1 compression: 1000; mse: 9.809918e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:03:34[0m] blocks.6.attn.qkv compression: 1000; mse: 1.602241e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:03:58[0m] blocks.6.attn.proj compression: 1000; mse: 1.708357e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:04:27[0m] blocks.6.mlp.fc1 compression: 1000; mse: 1.652811e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:04:56[0m] blocks.6.mlp.fc2 compression: 1000; mse: 1.963220e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:05:29[0m] blocks.6.adaLN_modulation.1 compression: 1000; mse: 9.170778e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:05:56[0m] blocks.7.attn.qkv compression: 1000; mse: 1.721809e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:06:20[0m] blocks.7.attn.proj compression: 1000; mse: 1.604176e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:06:49[0m] blocks.7.mlp.fc1 compression: 1000; mse: 1.773273e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:07:18[0m] blocks.7.mlp.fc2 compression: 1000; mse: 2.004869e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:07:51[0m] blocks.7.adaLN_modulation.1 compression: 1000; mse: 1.086483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:08:19[0m] blocks.8.attn.qkv compression: 1000; mse: 1.769114e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:08:43[0m] blocks.8.attn.proj compression: 1000; mse: 1.904257e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:09:12[0m] blocks.8.mlp.fc1 compression: 1000; mse: 1.858805e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:09:41[0m] blocks.8.mlp.fc2 compression: 1000; mse: 2.139965e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:10:14[0m] blocks.8.adaLN_modulation.1 compression: 1000; mse: 1.155304e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:10:42[0m] blocks.9.attn.qkv compression: 1000; mse: 1.772857e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:11:06[0m] blocks.9.attn.proj compression: 1000; mse: 2.007805e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:11:35[0m] blocks.9.mlp.fc1 compression: 1000; mse: 1.904299e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:12:04[0m] blocks.9.mlp.fc2 compression: 1000; mse: 2.249118e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:12:37[0m] blocks.9.adaLN_modulation.1 compression: 1000; mse: 1.319698e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:13:05[0m] blocks.10.attn.qkv compression: 1000; mse: 1.769889e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:13:28[0m] blocks.10.attn.proj compression: 1000; mse: 2.191791e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:13:58[0m] blocks.10.mlp.fc1 compression: 1000; mse: 1.966307e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:14:27[0m] blocks.10.mlp.fc2 compression: 1000; mse: 2.382253e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:15:00[0m] blocks.10.adaLN_modulation.1 compression: 1000; mse: 1.698302e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:15:27[0m] blocks.11.attn.qkv compression: 1000; mse: 1.805447e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:15:51[0m] blocks.11.attn.proj compression: 1000; mse: 2.103099e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:16:20[0m] blocks.11.mlp.fc1 compression: 1000; mse: 1.971021e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:16:49[0m] blocks.11.mlp.fc2 compression: 1000; mse: 2.431537e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:17:22[0m] blocks.11.adaLN_modulation.1 compression: 1000; mse: 1.581191e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:17:50[0m] blocks.12.attn.qkv compression: 1000; mse: 1.850807e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:18:14[0m] blocks.12.attn.proj compression: 1000; mse: 2.316541e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:18:43[0m] blocks.12.mlp.fc1 compression: 1000; mse: 1.957412e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:19:12[0m] blocks.12.mlp.fc2 compression: 1000; mse: 2.432965e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:19:45[0m] blocks.12.adaLN_modulation.1 compression: 1000; mse: 1.586206e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:20:13[0m] blocks.13.attn.qkv compression: 1000; mse: 2.027285e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:20:37[0m] blocks.13.attn.proj compression: 1000; mse: 2.346170e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:21:06[0m] blocks.13.mlp.fc1 compression: 1000; mse: 1.893710e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:21:35[0m] blocks.13.mlp.fc2 compression: 1000; mse: 2.414092e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:22:08[0m] blocks.13.adaLN_modulation.1 compression: 1000; mse: 1.526879e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:22:36[0m] blocks.14.attn.qkv compression: 1000; mse: 1.919666e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:22:59[0m] blocks.14.attn.proj compression: 1000; mse: 2.435264e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:23:29[0m] blocks.14.mlp.fc1 compression: 1000; mse: 1.894395e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:23:58[0m] blocks.14.mlp.fc2 compression: 1000; mse: 2.587469e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:24:31[0m] blocks.14.adaLN_modulation.1 compression: 1000; mse: 1.869856e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:24:58[0m] blocks.15.attn.qkv compression: 1000; mse: 1.998632e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:25:22[0m] blocks.15.attn.proj compression: 1000; mse: 2.402870e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:25:52[0m] blocks.15.mlp.fc1 compression: 1000; mse: 1.860853e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:26:21[0m] blocks.15.mlp.fc2 compression: 1000; mse: 2.521253e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:26:54[0m] blocks.15.adaLN_modulation.1 compression: 1000; mse: 1.674303e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:27:21[0m] blocks.16.attn.qkv compression: 1000; mse: 2.145478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:27:45[0m] blocks.16.attn.proj compression: 1000; mse: 2.381409e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:28:14[0m] blocks.16.mlp.fc1 compression: 1000; mse: 1.795489e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:28:44[0m] blocks.16.mlp.fc2 compression: 1000; mse: 2.444266e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:29:17[0m] blocks.16.adaLN_modulation.1 compression: 1000; mse: 1.371870e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:29:44[0m] blocks.17.attn.qkv compression: 1000; mse: 2.054746e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:30:08[0m] blocks.17.attn.proj compression: 1000; mse: 2.463474e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:30:37[0m] blocks.17.mlp.fc1 compression: 1000; mse: 1.764557e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:31:07[0m] blocks.17.mlp.fc2 compression: 1000; mse: 2.466746e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:31:40[0m] blocks.17.adaLN_modulation.1 compression: 1000; mse: 1.321043e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:32:07[0m] blocks.18.attn.qkv compression: 1000; mse: 2.008011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:32:31[0m] blocks.18.attn.proj compression: 1000; mse: 2.528407e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:33:00[0m] blocks.18.mlp.fc1 compression: 1000; mse: 1.779605e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:33:30[0m] blocks.18.mlp.fc2 compression: 1000; mse: 2.463819e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:34:03[0m] blocks.18.adaLN_modulation.1 compression: 1000; mse: 1.291974e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:34:30[0m] blocks.19.attn.qkv compression: 1000; mse: 1.954242e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:34:54[0m] blocks.19.attn.proj compression: 1000; mse: 2.474125e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:35:23[0m] blocks.19.mlp.fc1 compression: 1000; mse: 1.749971e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:35:53[0m] blocks.19.mlp.fc2 compression: 1000; mse: 2.534788e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:36:26[0m] blocks.19.adaLN_modulation.1 compression: 1000; mse: 1.292627e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:36:53[0m] blocks.20.attn.qkv compression: 1000; mse: 1.975776e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:37:17[0m] blocks.20.attn.proj compression: 1000; mse: 2.622409e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:37:46[0m] blocks.20.mlp.fc1 compression: 1000; mse: 1.768696e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:38:16[0m] blocks.20.mlp.fc2 compression: 1000; mse: 2.565231e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:38:49[0m] blocks.20.adaLN_modulation.1 compression: 1000; mse: 1.346694e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:39:16[0m] blocks.21.attn.qkv compression: 1000; mse: 1.887958e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:39:40[0m] blocks.21.attn.proj compression: 1000; mse: 2.659318e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:40:10[0m] blocks.21.mlp.fc1 compression: 1000; mse: 1.795531e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:40:39[0m] blocks.21.mlp.fc2 compression: 1000; mse: 2.615868e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:41:12[0m] blocks.21.adaLN_modulation.1 compression: 1000; mse: 1.431723e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:41:40[0m] blocks.22.attn.qkv compression: 1000; mse: 1.844585e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:42:03[0m] blocks.22.attn.proj compression: 1000; mse: 2.665209e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:42:33[0m] blocks.22.mlp.fc1 compression: 1000; mse: 1.775678e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:43:02[0m] blocks.22.mlp.fc2 compression: 1000; mse: 2.573509e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:43:35[0m] blocks.22.adaLN_modulation.1 compression: 1000; mse: 1.434964e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:44:02[0m] blocks.23.attn.qkv compression: 1000; mse: 1.869353e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:44:26[0m] blocks.23.attn.proj compression: 1000; mse: 2.631523e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:44:56[0m] blocks.23.mlp.fc1 compression: 1000; mse: 1.749365e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:45:25[0m] blocks.23.mlp.fc2 compression: 1000; mse: 2.676450e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:45:58[0m] blocks.23.adaLN_modulation.1 compression: 1000; mse: 1.467838e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:46:25[0m] blocks.24.attn.qkv compression: 1000; mse: 1.875529e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:46:49[0m] blocks.24.attn.proj compression: 1000; mse: 2.877039e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:47:18[0m] blocks.24.mlp.fc1 compression: 1000; mse: 1.714125e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:47:48[0m] blocks.24.mlp.fc2 compression: 1000; mse: 2.688817e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:48:21[0m] blocks.24.adaLN_modulation.1 compression: 1000; mse: 1.386063e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:48:48[0m] blocks.25.attn.qkv compression: 1000; mse: 1.933233e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:49:12[0m] blocks.25.attn.proj compression: 1000; mse: 2.860930e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:49:41[0m] blocks.25.mlp.fc1 compression: 1000; mse: 1.640132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:50:11[0m] blocks.25.mlp.fc2 compression: 1000; mse: 2.707800e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:50:44[0m] blocks.25.adaLN_modulation.1 compression: 1000; mse: 1.293151e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:51:11[0m] blocks.26.attn.qkv compression: 1000; mse: 1.749674e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:51:35[0m] blocks.26.attn.proj compression: 1000; mse: 2.626899e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:52:04[0m] blocks.26.mlp.fc1 compression: 1000; mse: 1.406641e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:52:34[0m] blocks.26.mlp.fc2 compression: 1000; mse: 1.224584e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:53:07[0m] blocks.26.adaLN_modulation.1 compression: 1000; mse: 8.026871e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:53:34[0m] blocks.27.attn.qkv compression: 1000; mse: 1.439805e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 16:53:58[0m] blocks.27.attn.proj compression: 1000; mse: 8.821069e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 16:54:27[0m] blocks.27.mlp.fc1 compression: 1000; mse: 5.228269e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 16:54:56[0m] blocks.27.mlp.fc2 compression: 1000; mse: 1.430990e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 16:55:30[0m] blocks.27.adaLN_modulation.1 compression: 1000; mse: 4.652555e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 16:55:30[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 16:55:30[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 16:55:30[0m] Compression ratio: 14.02
[[34m2024-10-22 16:59:07[0m] Dataset contains 1,281,167 images (/mnt/petrelfs/share/images/train)
[[34m2024-10-22 16:59:07[0m] Training for 1 epochs...
[[34m2024-10-22 16:59:07[0m] Beginning epoch 0...
[[34m2024-10-22 17:00:09[0m] (step=0000100) Train Loss: 0.1602, Train Steps/Sec: 1.59
[[34m2024-10-22 17:01:10[0m] (step=0000200) Train Loss: 0.1498, Train Steps/Sec: 1.65
[[34m2024-10-22 17:02:11[0m] (step=0000300) Train Loss: 0.1478, Train Steps/Sec: 1.65
[[34m2024-10-22 17:03:11[0m] (step=0000400) Train Loss: 0.1477, Train Steps/Sec: 1.65
[[34m2024-10-22 17:04:12[0m] (step=0000500) Train Loss: 0.1472, Train Steps/Sec: 1.65
[[34m2024-10-22 17:05:13[0m] (step=0000600) Train Loss: 0.1488, Train Steps/Sec: 1.65
[[34m2024-10-22 17:06:14[0m] (step=0000700) Train Loss: 0.1463, Train Steps/Sec: 1.64
[[34m2024-10-22 17:07:15[0m] (step=0000800) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-10-22 17:08:15[0m] (step=0000900) Train Loss: 0.1454, Train Steps/Sec: 1.65
[[34m2024-10-22 17:09:16[0m] (step=0001000) Train Loss: 0.1477, Train Steps/Sec: 1.65
[[34m2024-10-22 17:10:17[0m] (step=0001100) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-10-22 17:11:17[0m] (step=0001200) Train Loss: 0.1474, Train Steps/Sec: 1.65
[[34m2024-10-22 17:12:18[0m] (step=0001300) Train Loss: 0.1480, Train Steps/Sec: 1.65
[[34m2024-10-22 17:13:19[0m] (step=0001400) Train Loss: 0.1460, Train Steps/Sec: 1.65
[[34m2024-10-22 17:14:19[0m] (step=0001500) Train Loss: 0.1455, Train Steps/Sec: 1.65
[[34m2024-10-22 17:15:20[0m] (step=0001600) Train Loss: 0.1445, Train Steps/Sec: 1.65
[[34m2024-10-22 17:16:21[0m] (step=0001700) Train Loss: 0.1480, Train Steps/Sec: 1.65
[[34m2024-10-22 17:17:21[0m] (step=0001800) Train Loss: 0.1476, Train Steps/Sec: 1.65
[[34m2024-10-22 17:18:22[0m] (step=0001900) Train Loss: 0.1462, Train Steps/Sec: 1.65
[[34m2024-10-22 17:19:23[0m] (step=0002000) Train Loss: 0.1467, Train Steps/Sec: 1.65
[[34m2024-10-22 17:20:24[0m] (step=0002100) Train Loss: 0.1463, Train Steps/Sec: 1.64
[[34m2024-10-22 17:21:24[0m] (step=0002200) Train Loss: 0.1466, Train Steps/Sec: 1.65
[[34m2024-10-22 17:22:25[0m] (step=0002300) Train Loss: 0.1417, Train Steps/Sec: 1.65
[[34m2024-10-22 17:23:26[0m] (step=0002400) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-10-22 17:24:26[0m] (step=0002500) Train Loss: 0.1456, Train Steps/Sec: 1.65
[[34m2024-10-22 17:25:27[0m] (step=0002600) Train Loss: 0.1476, Train Steps/Sec: 1.65
[[34m2024-10-22 17:26:28[0m] (step=0002700) Train Loss: 0.1465, Train Steps/Sec: 1.65
[[34m2024-10-22 17:27:28[0m] (step=0002800) Train Loss: 0.1448, Train Steps/Sec: 1.65
[[34m2024-10-22 17:28:29[0m] (step=0002900) Train Loss: 0.1451, Train Steps/Sec: 1.65
[[34m2024-10-22 17:29:30[0m] (step=0003000) Train Loss: 0.1461, Train Steps/Sec: 1.65
[[34m2024-10-22 17:30:30[0m] (step=0003100) Train Loss: 0.1464, Train Steps/Sec: 1.65
[[34m2024-10-22 17:31:31[0m] (step=0003200) Train Loss: 0.1491, Train Steps/Sec: 1.65
[[34m2024-10-22 17:32:32[0m] (step=0003300) Train Loss: 0.1471, Train Steps/Sec: 1.65
[[34m2024-10-22 17:33:33[0m] (step=0003400) Train Loss: 0.1449, Train Steps/Sec: 1.65
[[34m2024-10-22 17:34:33[0m] (step=0003500) Train Loss: 0.1446, Train Steps/Sec: 1.65
[[34m2024-10-22 17:35:34[0m] (step=0003600) Train Loss: 0.1444, Train Steps/Sec: 1.65
[[34m2024-10-22 17:36:35[0m] (step=0003700) Train Loss: 0.1455, Train Steps/Sec: 1.65
[[34m2024-10-22 17:37:35[0m] (step=0003800) Train Loss: 0.1451, Train Steps/Sec: 1.65
[[34m2024-10-22 17:38:36[0m] (step=0003900) Train Loss: 0.1437, Train Steps/Sec: 1.65
[[34m2024-10-22 17:39:37[0m] (step=0004000) Train Loss: 0.1465, Train Steps/Sec: 1.65
[[34m2024-10-22 17:40:37[0m] (step=0004100) Train Loss: 0.1436, Train Steps/Sec: 1.65
[[34m2024-10-22 17:41:38[0m] (step=0004200) Train Loss: 0.1431, Train Steps/Sec: 1.65
[[34m2024-10-22 17:42:39[0m] (step=0004300) Train Loss: 0.1434, Train Steps/Sec: 1.64
[[34m2024-10-22 17:43:40[0m] (step=0004400) Train Loss: 0.1427, Train Steps/Sec: 1.65
[[34m2024-10-22 17:44:40[0m] (step=0004500) Train Loss: 0.1440, Train Steps/Sec: 1.65
[[34m2024-10-22 17:45:41[0m] (step=0004600) Train Loss: 0.1449, Train Steps/Sec: 1.65
[[34m2024-10-22 17:46:42[0m] (step=0004700) Train Loss: 0.1489, Train Steps/Sec: 1.65
[[34m2024-10-22 17:47:43[0m] (step=0004800) Train Loss: 0.1438, Train Steps/Sec: 1.65
[[34m2024-10-22 17:48:43[0m] (step=0004900) Train Loss: 0.1463, Train Steps/Sec: 1.65
[[34m2024-10-22 17:49:44[0m] (step=0005000) Train Loss: 0.1445, Train Steps/Sec: 1.65
[[34m2024-10-22 17:49:44[0m] Saved checkpoint to results/train_pq/001-DiT-XL-2/checkpoints/0005000.pt
[[34m2024-10-22 17:49:47[0m] Done!
[[34m2024-10-22 17:49:47[0m] Done!
[[34m2024-10-23 12:57:53[0m] Experiment directory created at results/train_pq/001-DiT-XL-2
[[34m2024-10-23 12:58:35[0m] blocks.0.attn.qkv compression: 1000; mse: 1.223202e-03; codebook size: 256 x 4; code size: 3456 x 288
