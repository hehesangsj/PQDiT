[[34m2024-10-22 14:46:19[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 14:47:07[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:07[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:07[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:07[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:07[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:07[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:07[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:07[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:07[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:07[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:07[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:07[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:07[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:07[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:08[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:08[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:08[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:08[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:08[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:08[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:08[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:08[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:08[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:08[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:08[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:08[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:08[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:09[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:09[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:09[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:09[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:09[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:09[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:09[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:09[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:09[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:09[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:09[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:09[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:09[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:09[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:10[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:10[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:10[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:10[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:10[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:10[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:10[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:10[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:10[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:10[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:10[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:10[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:10[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:11[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:11[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:11[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:11[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:11[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:11[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:11[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:11[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:11[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:11[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:11[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:11[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:11[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:12[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:12[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:12[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:12[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:12[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:12[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:12[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:12[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:12[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:12[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:12[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:12[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:12[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:12[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:13[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:13[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:13[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:13[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:13[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:13[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:13[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:13[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:13[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:13[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:13[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:13[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:13[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:13[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:14[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:14[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:14[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:14[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:14[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:14[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:14[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:14[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:14[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:14[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:14[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:14[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:14[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:15[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:15[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:15[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:15[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:15[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:15[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:15[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:15[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:15[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:15[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:15[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:15[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:15[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:15[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:16[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:16[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:16[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:16[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:16[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:16[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:16[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:16[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:16[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:16[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:16[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:16[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:16[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:16[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 14:47:17[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 14:47:17[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 14:47:17[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 14:47:17[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 14:47:49[0m] Uncompressed model size: 1540629504 bits
[[34m2024-10-22 14:47:49[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 14:47:52[0m] Compression ratio: 1.00
[[34m2024-10-22 15:00:20[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:00:40[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:40[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:40[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:40[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:40[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:40[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:40[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:40[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:40[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:40[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:40[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:40[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:40[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:40[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:41[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:41[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:41[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:41[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:41[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:41[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:41[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:41[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:41[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:41[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:41[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:41[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:41[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:42[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:42[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:42[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:42[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:42[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:42[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:42[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:42[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:42[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:42[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:42[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:42[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:42[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:42[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:43[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:43[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:43[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:43[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:43[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:43[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:43[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:43[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:43[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:43[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:43[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:43[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:43[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:44[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:44[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:44[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:44[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:44[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:44[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:44[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:44[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:44[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:44[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:44[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:44[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:44[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:44[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:45[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:45[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:45[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:45[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:45[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:45[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:45[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:45[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:45[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:45[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:45[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:45[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:45[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:46[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:46[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:46[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:46[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:46[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:46[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:46[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:46[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:46[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:46[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:46[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:46[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:46[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:47[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:47[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:47[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:47[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:47[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:47[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:47[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:47[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:47[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:47[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:47[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:47[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:47[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:47[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:48[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:48[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:48[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:48[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:48[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:48[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:48[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:48[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:48[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:48[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:48[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:48[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:48[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:48[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:49[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:49[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:49[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:49[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:49[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:49[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:49[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:49[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:49[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:49[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:49[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:49[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:49[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:50[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:00:50[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:00:50[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:00:50[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:00:50[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:00:53[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 15:00:53[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 15:00:53[0m] Compression ratio: 14.02
[[34m2024-10-22 15:03:06[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:03:34[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:34[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:34[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:34[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:34[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:34[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:34[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:34[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:34[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:35[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:35[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:35[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:35[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:35[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:35[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:35[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:35[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:35[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:35[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:35[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:35[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:35[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:36[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:36[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:36[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:36[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:36[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:36[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:36[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:36[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:36[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:36[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:36[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:36[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:36[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:36[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:37[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:37[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:37[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:37[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:37[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:37[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:37[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:37[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:37[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:37[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:37[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:37[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:37[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:38[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:38[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:38[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:38[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:38[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:38[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:38[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:38[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:38[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:38[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:38[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:38[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:38[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:38[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:39[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:39[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:39[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:39[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:39[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:39[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:39[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:39[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:39[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:39[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:39[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:39[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:39[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:39[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:40[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:40[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:40[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:40[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:40[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:40[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:40[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:40[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:40[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:40[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:40[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:40[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:40[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:40[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:41[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:41[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:41[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:41[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:41[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:41[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:41[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:41[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:41[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:41[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:41[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:41[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:41[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:42[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:42[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:42[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:42[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:42[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:42[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:42[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:42[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:42[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:42[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:42[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:42[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:42[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:42[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:43[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:43[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:43[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:43[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:43[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:43[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:43[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:43[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:43[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:43[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:43[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:43[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:43[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:43[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:44[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:44[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:44[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:44[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:03:44[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:03:44[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:03:44[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:03:44[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:03:44[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 15:03:44[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 15:03:44[0m] Compression ratio: 14.02
[[34m2024-10-22 15:04:37[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:05:11[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:11[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:11[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:11[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:11[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:11[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:12[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:12[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:12[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:12[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:12[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:12[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:12[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:12[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:12[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:12[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:12[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:12[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:12[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:13[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:13[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:13[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:13[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:13[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:13[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:13[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:13[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:13[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:13[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:13[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:13[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:13[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:13[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:14[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:14[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:14[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:14[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:14[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:14[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:14[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:14[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:14[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:14[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:14[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:14[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:14[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:14[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:15[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:15[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:15[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:15[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:15[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:15[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:15[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:15[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:15[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:15[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:15[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:15[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:15[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:16[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:16[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:16[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:16[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:16[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:16[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:16[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:16[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:16[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:16[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:16[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:16[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:16[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:16[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:17[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:17[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:17[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:17[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:17[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:17[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:17[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:17[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:17[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:17[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:17[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:17[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:17[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:17[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:18[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:18[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:18[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:18[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:18[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:18[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:18[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:18[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:18[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:18[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:18[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:18[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:18[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:19[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:19[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:19[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:19[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:19[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:19[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:19[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:19[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:19[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:19[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:19[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:19[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:19[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:19[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:20[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:20[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:20[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:20[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:20[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:20[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:20[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:20[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:20[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:20[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:20[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:20[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:20[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:20[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:21[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:21[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:21[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:21[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:21[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:21[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:21[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:05:21[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:05:21[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:05:21[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:05:21[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:05:21[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 15:05:21[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 15:05:21[0m] Compression ratio: 14.02
[[34m2024-10-22 15:05:22[0m] Saved checkpoint to results/train_pq/debug/004-DiT-XL-2/checkpoints/ckpt.pt
[[34m2024-10-22 15:06:18[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:06:32[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:32[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:33[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:33[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:33[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:33[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:33[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:33[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:33[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:33[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:33[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:33[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:33[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:33[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:33[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:34[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:34[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:34[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:34[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:34[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:34[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:34[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:34[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:34[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:34[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:34[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:34[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:34[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:34[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:35[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:35[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:35[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:35[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:35[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:35[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:35[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:35[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:35[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:35[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:35[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:35[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:35[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:35[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:36[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:36[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:36[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:36[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:36[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:36[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:36[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:36[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:36[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:36[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:36[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:36[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:36[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:37[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:37[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:37[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:37[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:37[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:37[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:37[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:37[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:37[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:37[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:37[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:37[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:37[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:37[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:38[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:38[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:38[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:38[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:38[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:38[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:38[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:38[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:38[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:38[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:38[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:38[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:38[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:39[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:39[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:39[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:39[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:39[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:39[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:39[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:39[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:39[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:39[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:39[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:39[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:39[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:39[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:40[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:40[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:40[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:40[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:40[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:40[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:40[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:40[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:40[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:40[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:40[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:40[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:40[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:41[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:41[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:41[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:41[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:41[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:41[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:41[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:41[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:41[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:41[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:41[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:41[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:41[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:41[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:42[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:42[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:42[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:42[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:42[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:42[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:42[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:42[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:42[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:42[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:42[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:42[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:06:42[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:06:43[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:06:43[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:06:43[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:06:43[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 15:06:43[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 15:06:43[0m] Compression ratio: 14.02
[[34m2024-10-22 15:06:43[0m] Saved checkpoint to results/train_pq/debug/004-DiT-XL-2/checkpoints/ckpt.pt
[[34m2024-10-22 15:07:14[0m] Done!
[[34m2024-10-22 15:09:12[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:09:26[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:27[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:27[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:27[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:27[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:27[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:27[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:27[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:27[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:27[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:27[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:27[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:27[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:27[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:28[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:28[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:28[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:28[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:28[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:28[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:28[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:28[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:28[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:28[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:28[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:28[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:28[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:28[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:28[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:29[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:29[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:29[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:29[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:29[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:29[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:29[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:29[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:29[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:29[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:29[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:29[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:29[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:30[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:30[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:30[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:30[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:30[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:30[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:30[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:30[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:30[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:30[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:30[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:30[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:30[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:30[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:31[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:31[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:31[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:31[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:31[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:31[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:31[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:31[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:31[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:31[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:31[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:31[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:31[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:31[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:32[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:32[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:32[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:32[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:32[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:32[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:32[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:32[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:32[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:32[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:32[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:32[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:32[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:32[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:33[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:33[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:33[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:33[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:33[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:33[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:33[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:33[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:33[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:33[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:33[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:33[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:33[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:33[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:34[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:34[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:34[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:34[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:34[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:34[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:34[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:34[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:34[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:34[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:34[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:34[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:34[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:35[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:35[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:35[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:35[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:35[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:35[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:35[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:35[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:35[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:35[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:35[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:35[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:35[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:35[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:36[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:36[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:36[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:36[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:36[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:36[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:36[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:36[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:36[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:36[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:36[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:09:36[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:09:36[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:09:36[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:09:37[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:09:37[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 15:09:37[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 15:09:37[0m] Compression ratio: 14.02
[[34m2024-10-22 15:09:37[0m] Saved checkpoint to results/train_pq/debug/004-DiT-XL-2/checkpoints/ckpt.pt
[[34m2024-10-22 15:10:04[0m] Done!
[[34m2024-10-22 15:18:35[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:19:16[0m] blocks.0.attn.qkv compression: 1000; mse: 1.223202e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:19:40[0m] blocks.0.attn.proj compression: 1000; mse: 5.784003e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:20:10[0m] blocks.0.mlp.fc1 compression: 1000; mse: 4.114613e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:20:40[0m] blocks.0.mlp.fc2 compression: 1000; mse: 2.412441e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:21:14[0m] blocks.0.adaLN_modulation.1 compression: 1000; mse: 9.226966e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:03[0m] Experiment directory created at results/train_pq/debug/004-DiT-XL-2
[[34m2024-10-22 15:22:17[0m] blocks.0.attn.qkv compression: 1; mse: 1.931743e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:17[0m] blocks.0.attn.proj compression: 1; mse: 7.651448e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:17[0m] blocks.0.mlp.fc1 compression: 1; mse: 6.433387e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:17[0m] blocks.0.mlp.fc2 compression: 1; mse: 3.792303e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:17[0m] blocks.0.adaLN_modulation.1 compression: 1; mse: 1.183982e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:18[0m] blocks.1.attn.qkv compression: 1; mse: 2.536416e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:18[0m] blocks.1.attn.proj compression: 1; mse: 8.949419e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:18[0m] blocks.1.mlp.fc1 compression: 1; mse: 1.432540e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:18[0m] blocks.1.mlp.fc2 compression: 1; mse: 1.908048e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:18[0m] blocks.1.adaLN_modulation.1 compression: 1; mse: 8.053609e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:18[0m] blocks.2.attn.qkv compression: 1; mse: 2.930036e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:18[0m] blocks.2.attn.proj compression: 1; mse: 5.513457e-03; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:18[0m] blocks.2.mlp.fc1 compression: 1; mse: 7.816268e-04; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:18[0m] blocks.2.mlp.fc2 compression: 1; mse: 2.906519e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:18[0m] blocks.2.adaLN_modulation.1 compression: 1; mse: 8.839010e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:18[0m] blocks.3.attn.qkv compression: 1; mse: 6.429398e-03; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:18[0m] blocks.3.attn.proj compression: 1; mse: 1.257213e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:18[0m] blocks.3.mlp.fc1 compression: 1; mse: 2.449909e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:18[0m] blocks.3.mlp.fc2 compression: 1; mse: 3.500100e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:19[0m] blocks.3.adaLN_modulation.1 compression: 1; mse: 1.002991e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:19[0m] blocks.4.attn.qkv compression: 1; mse: 1.230777e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:19[0m] blocks.4.attn.proj compression: 1; mse: 1.416760e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:19[0m] blocks.4.mlp.fc1 compression: 1; mse: 1.129873e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:19[0m] blocks.4.mlp.fc2 compression: 1; mse: 1.112744e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:19[0m] blocks.4.adaLN_modulation.1 compression: 1; mse: 1.128247e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:19[0m] blocks.5.attn.qkv compression: 1; mse: 1.492478e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:19[0m] blocks.5.attn.proj compression: 1; mse: 1.627102e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:19[0m] blocks.5.mlp.fc1 compression: 1; mse: 1.687178e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:19[0m] blocks.5.mlp.fc2 compression: 1; mse: 2.139617e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:19[0m] blocks.5.adaLN_modulation.1 compression: 1; mse: 1.284245e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:19[0m] blocks.6.attn.qkv compression: 1; mse: 2.291430e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:19[0m] blocks.6.attn.proj compression: 1; mse: 1.932911e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:19[0m] blocks.6.mlp.fc1 compression: 1; mse: 1.860552e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:20[0m] blocks.6.mlp.fc2 compression: 1; mse: 2.230269e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:20[0m] blocks.6.adaLN_modulation.1 compression: 1; mse: 1.162541e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:20[0m] blocks.7.attn.qkv compression: 1; mse: 1.926468e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:20[0m] blocks.7.attn.proj compression: 1; mse: 1.811661e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:20[0m] blocks.7.mlp.fc1 compression: 1; mse: 1.985113e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:20[0m] blocks.7.mlp.fc2 compression: 1; mse: 2.263786e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:20[0m] blocks.7.adaLN_modulation.1 compression: 1; mse: 1.347917e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:20[0m] blocks.8.attn.qkv compression: 1; mse: 2.035476e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:20[0m] blocks.8.attn.proj compression: 1; mse: 2.162638e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:20[0m] blocks.8.mlp.fc1 compression: 1; mse: 2.083487e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:20[0m] blocks.8.mlp.fc2 compression: 1; mse: 2.432903e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:20[0m] blocks.8.adaLN_modulation.1 compression: 1; mse: 1.398505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:20[0m] blocks.9.attn.qkv compression: 1; mse: 2.061083e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:21[0m] blocks.9.attn.proj compression: 1; mse: 2.251003e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:21[0m] blocks.9.mlp.fc1 compression: 1; mse: 2.126298e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:21[0m] blocks.9.mlp.fc2 compression: 1; mse: 2.537418e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:21[0m] blocks.9.adaLN_modulation.1 compression: 1; mse: 1.598824e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:21[0m] blocks.10.attn.qkv compression: 1; mse: 1.983946e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:21[0m] blocks.10.attn.proj compression: 1; mse: 2.466145e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:21[0m] blocks.10.mlp.fc1 compression: 1; mse: 2.210132e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:21[0m] blocks.10.mlp.fc2 compression: 1; mse: 2.689888e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:21[0m] blocks.10.adaLN_modulation.1 compression: 1; mse: 2.009898e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:21[0m] blocks.11.attn.qkv compression: 1; mse: 2.028611e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:21[0m] blocks.11.attn.proj compression: 1; mse: 2.391445e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:21[0m] blocks.11.mlp.fc1 compression: 1; mse: 2.244975e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:21[0m] blocks.11.mlp.fc2 compression: 1; mse: 2.750895e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:21[0m] blocks.11.adaLN_modulation.1 compression: 1; mse: 1.908432e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:22[0m] blocks.12.attn.qkv compression: 1; mse: 2.075943e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:22[0m] blocks.12.attn.proj compression: 1; mse: 2.619996e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:22[0m] blocks.12.mlp.fc1 compression: 1; mse: 2.196411e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:22[0m] blocks.12.mlp.fc2 compression: 1; mse: 2.733932e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:22[0m] blocks.12.adaLN_modulation.1 compression: 1; mse: 1.896924e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:22[0m] blocks.13.attn.qkv compression: 1; mse: 2.368748e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:22[0m] blocks.13.attn.proj compression: 1; mse: 2.627193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:22[0m] blocks.13.mlp.fc1 compression: 1; mse: 2.135560e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:22[0m] blocks.13.mlp.fc2 compression: 1; mse: 2.712830e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:22[0m] blocks.13.adaLN_modulation.1 compression: 1; mse: 1.860821e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:22[0m] blocks.14.attn.qkv compression: 1; mse: 2.207063e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:22[0m] blocks.14.attn.proj compression: 1; mse: 2.756115e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:22[0m] blocks.14.mlp.fc1 compression: 1; mse: 2.149756e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:23[0m] blocks.14.mlp.fc2 compression: 1; mse: 2.879739e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:23[0m] blocks.14.adaLN_modulation.1 compression: 1; mse: 2.243008e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:23[0m] blocks.15.attn.qkv compression: 1; mse: 2.254530e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:23[0m] blocks.15.attn.proj compression: 1; mse: 2.699572e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:23[0m] blocks.15.mlp.fc1 compression: 1; mse: 2.076036e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:23[0m] blocks.15.mlp.fc2 compression: 1; mse: 2.823922e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:23[0m] blocks.15.adaLN_modulation.1 compression: 1; mse: 1.975872e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:23[0m] blocks.16.attn.qkv compression: 1; mse: 2.536011e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:23[0m] blocks.16.attn.proj compression: 1; mse: 2.664442e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:23[0m] blocks.16.mlp.fc1 compression: 1; mse: 1.993854e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:23[0m] blocks.16.mlp.fc2 compression: 1; mse: 2.702603e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:23[0m] blocks.16.adaLN_modulation.1 compression: 1; mse: 1.657132e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:23[0m] blocks.17.attn.qkv compression: 1; mse: 2.382979e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:23[0m] blocks.17.attn.proj compression: 1; mse: 2.763657e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:24[0m] blocks.17.mlp.fc1 compression: 1; mse: 1.954426e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:24[0m] blocks.17.mlp.fc2 compression: 1; mse: 2.731755e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:24[0m] blocks.17.adaLN_modulation.1 compression: 1; mse: 1.614911e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:24[0m] blocks.18.attn.qkv compression: 1; mse: 2.291676e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:24[0m] blocks.18.attn.proj compression: 1; mse: 2.869644e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:24[0m] blocks.18.mlp.fc1 compression: 1; mse: 1.991319e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:24[0m] blocks.18.mlp.fc2 compression: 1; mse: 2.788939e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:24[0m] blocks.18.adaLN_modulation.1 compression: 1; mse: 1.619300e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:24[0m] blocks.19.attn.qkv compression: 1; mse: 2.262970e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:24[0m] blocks.19.attn.proj compression: 1; mse: 2.765604e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:24[0m] blocks.19.mlp.fc1 compression: 1; mse: 1.961452e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:24[0m] blocks.19.mlp.fc2 compression: 1; mse: 2.855818e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:24[0m] blocks.19.adaLN_modulation.1 compression: 1; mse: 1.665436e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:24[0m] blocks.20.attn.qkv compression: 1; mse: 2.220076e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:25[0m] blocks.20.attn.proj compression: 1; mse: 2.990608e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:25[0m] blocks.20.mlp.fc1 compression: 1; mse: 1.990911e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:25[0m] blocks.20.mlp.fc2 compression: 1; mse: 2.875808e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:25[0m] blocks.20.adaLN_modulation.1 compression: 1; mse: 1.712527e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:25[0m] blocks.21.attn.qkv compression: 1; mse: 2.127216e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:25[0m] blocks.21.attn.proj compression: 1; mse: 2.997589e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:25[0m] blocks.21.mlp.fc1 compression: 1; mse: 2.010284e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:25[0m] blocks.21.mlp.fc2 compression: 1; mse: 2.921247e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:25[0m] blocks.21.adaLN_modulation.1 compression: 1; mse: 2.040505e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:25[0m] blocks.22.attn.qkv compression: 1; mse: 2.093504e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:25[0m] blocks.22.attn.proj compression: 1; mse: 3.061811e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:25[0m] blocks.22.mlp.fc1 compression: 1; mse: 2.000603e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:25[0m] blocks.22.mlp.fc2 compression: 1; mse: 2.854368e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:26[0m] blocks.22.adaLN_modulation.1 compression: 1; mse: 1.930205e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:26[0m] blocks.23.attn.qkv compression: 1; mse: 2.192927e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:26[0m] blocks.23.attn.proj compression: 1; mse: 2.984158e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:26[0m] blocks.23.mlp.fc1 compression: 1; mse: 1.942801e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:26[0m] blocks.23.mlp.fc2 compression: 1; mse: 3.022310e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:26[0m] blocks.23.adaLN_modulation.1 compression: 1; mse: 2.536590e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:26[0m] blocks.24.attn.qkv compression: 1; mse: 2.154192e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:26[0m] blocks.24.attn.proj compression: 1; mse: 3.268193e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:26[0m] blocks.24.mlp.fc1 compression: 1; mse: 1.925473e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:26[0m] blocks.24.mlp.fc2 compression: 1; mse: 3.008521e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:26[0m] blocks.24.adaLN_modulation.1 compression: 1; mse: 1.966816e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:26[0m] blocks.25.attn.qkv compression: 1; mse: 2.197007e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:26[0m] blocks.25.attn.proj compression: 1; mse: 3.261364e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:26[0m] blocks.25.mlp.fc1 compression: 1; mse: 1.876347e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:27[0m] blocks.25.mlp.fc2 compression: 1; mse: 3.068839e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:27[0m] blocks.25.adaLN_modulation.1 compression: 1; mse: 2.109779e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:27[0m] blocks.26.attn.qkv compression: 1; mse: 2.015133e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:27[0m] blocks.26.attn.proj compression: 1; mse: 2.987441e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:27[0m] blocks.26.mlp.fc1 compression: 1; mse: 1.565103e-02; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:27[0m] blocks.26.mlp.fc2 compression: 1; mse: 1.639421e-02; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:27[0m] blocks.26.adaLN_modulation.1 compression: 1; mse: 1.382483e-02; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:27[0m] blocks.27.attn.qkv compression: 1; mse: 1.645899e-02; codebook size: 256 x 4; code size: 3456 x 288
[[34m2024-10-22 15:22:27[0m] blocks.27.attn.proj compression: 1; mse: 1.427153e-02; codebook size: 256 x 4; code size: 1152 x 288
[[34m2024-10-22 15:22:27[0m] blocks.27.mlp.fc1 compression: 1; mse: 6.083924e-03; codebook size: 256 x 4; code size: 4608 x 288
[[34m2024-10-22 15:22:27[0m] blocks.27.mlp.fc2 compression: 1; mse: 5.770746e-03; codebook size: 256 x 4; code size: 1152 x 1152
[[34m2024-10-22 15:22:27[0m] blocks.27.adaLN_modulation.1 compression: 1; mse: 6.938077e-03; codebook size: 256 x 4; code size: 6912 x 288
[[34m2024-10-22 15:22:27[0m] Uncompressed model size: 21604148224 bits
[[34m2024-10-22 15:22:27[0m] Compressed model size: 1540629504 bits
[[34m2024-10-22 15:22:27[0m] Compression ratio: 14.02
[[34m2024-10-22 15:23:43[0m] Dataset contains 1,281,167 images (/mnt/petrelfs/share/images/train)
[[34m2024-10-22 15:23:43[0m] Training for 10 epochs...
[[34m2024-10-22 15:23:53[0m] Beginning epoch 0...
